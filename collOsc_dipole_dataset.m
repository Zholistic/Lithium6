

collOscDipoleData = [];

collOscDipoleData{1}.name = '160928_SloshingMode860G';
collOscDipoleData{1}.date = '160928';
collOscDipoleData{1}.magfield = 860;
collOscDipoleData{1}.ODcorr = 1.2;
collOscDipoleData{1}.freqguess = 26;
collOscDipoleData{1}.ampguessy = 4;
collOscDipoleData{1}.ampguessx = 10;
collOscDipoleData{1}.rotation = -10;%-20;

collOscDipoleData{2}.name = '161019_dipolecheck_690G';
collOscDipoleData{2}.date = '161019';
collOscDipoleData{2}.magfield = 690;
collOscDipoleData{2}.ODcorr = 1.2;
collOscDipoleData{2}.freqguess = 22;
collOscDipoleData{2}.ampguessy = 4;
collOscDipoleData{2}.ampguessx = 12;
collOscDipoleData{2}.rotation = -10;%15;

collOscDipoleData{3}.name = '161021_dipole_oscillation_check';
collOscDipoleData{3}.date = '161021';
collOscDipoleData{3}.magfield = 700;
collOscDipoleData{3}.ODcorr = 1.2;
collOscDipoleData{3}.freqguess = 22;
collOscDipoleData{3}.ampguessy = 2;
collOscDipoleData{3}.ampguessx = 6;
collOscDipoleData{3}.rotation = -10;%15;

collOscDipoleData{4}.name = '161021_Dipoleagain700G';
collOscDipoleData{4}.date = '161021';
collOscDipoleData{4}.magfield = 700;
collOscDipoleData{4}.ODcorr = 1.2;
collOscDipoleData{4}.freqguess = 22;
collOscDipoleData{4}.ampguessy = 3;
collOscDipoleData{4}.ampguessx = 6;
collOscDipoleData{4}.rotation = -10;%15;

collOscDipoleData{5}.name = '161024_dipole700G';
collOscDipoleData{5}.date = '161024';
collOscDipoleData{5}.magfield = 700;
collOscDipoleData{5}.ODcorr = 1.2;
collOscDipoleData{5}.freqguess = 22;
collOscDipoleData{5}.ampguessy = 2.5;
collOscDipoleData{5}.ampguessx = 7;
collOscDipoleData{5}.rotation = -10;%15;

collOscDipoleData{6}.name = '161026_dipole700';
collOscDipoleData{6}.date = '161026';
collOscDipoleData{6}.magfield = 700;
collOscDipoleData{6}.ODcorr = 1.2;
collOscDipoleData{6}.freqguess = 22;
collOscDipoleData{6}.ampguessy = 3;
collOscDipoleData{6}.ampguessx = 9;
collOscDipoleData{6}.rotation = -10;%15;

collOscDipoleData{7}.name = '161026_dipole700_13k';
collOscDipoleData{7}.date = '161026';
collOscDipoleData{7}.magfield = 700;
collOscDipoleData{7}.ODcorr = 1.2;
collOscDipoleData{7}.freqguess = 22;
collOscDipoleData{7}.ampguessy = 3;
collOscDipoleData{7}.ampguessx = 12;
collOscDipoleData{7}.rotation = -10;%15;

collOscDipoleData{8}.name = '161027_dipolemode700G';
collOscDipoleData{8}.date = '161027';
collOscDipoleData{8}.magfield = 700;
collOscDipoleData{8}.ODcorr = 1.2;
collOscDipoleData{8}.freqguess = 22;
collOscDipoleData{8}.ampguessy = 2.5;
collOscDipoleData{8}.ampguessx = 11;
collOscDipoleData{8}.rotation = -10;%15;

collOscDipoleData{9}.name = '161028_dipole750g';
collOscDipoleData{9}.date = '161028';
collOscDipoleData{9}.magfield = 750;
collOscDipoleData{9}.ODcorr = 1.2;
collOscDipoleData{9}.freqguess = 23;
collOscDipoleData{9}.ampguessy = 4;
collOscDipoleData{9}.ampguessx = 8;
collOscDipoleData{9}.rotation = -10;%15;

collOscDipoleData{10}.name = '161031_dipole680G';
collOscDipoleData{10}.date = '161031';
collOscDipoleData{10}.magfield = 680;
collOscDipoleData{10}.ODcorr = 1.2;
collOscDipoleData{10}.freqguess = 22;
collOscDipoleData{10}.ampguessy = 2;
collOscDipoleData{10}.ampguessx = 11;
collOscDipoleData{10}.rotation = -10;%15;

collOscDipoleData{11}.name = '161031_dipoleoscillation750G';
collOscDipoleData{11}.date = '161031';
collOscDipoleData{11}.magfield = 750;
collOscDipoleData{11}.ODcorr = 1.2;
collOscDipoleData{11}.freqguess = 23;
collOscDipoleData{11}.ampguessy = 3;
collOscDipoleData{11}.ampguessx = 9;
collOscDipoleData{11}.rotation = -10;%15;

collOscDipoleData{12}.name = '161101_dipole680';
collOscDipoleData{12}.date = '161101';
collOscDipoleData{12}.magfield = 680;
collOscDipoleData{12}.ODcorr = 1.2;
collOscDipoleData{12}.freqguess = 22;
collOscDipoleData{12}.ampguessy = 2.5;
collOscDipoleData{12}.ampguessx = 10;
collOscDipoleData{12}.rotation = -10;%-20;

collOscDipoleData{13}.name = '161130_dipole680G';
collOscDipoleData{13}.date = '161130';
collOscDipoleData{13}.magfield = 680;
collOscDipoleData{13}.ODcorr = 1.2;
collOscDipoleData{13}.freqguess = 22;
collOscDipoleData{13}.ampguessy = 3;
collOscDipoleData{13}.ampguessx = 8;
collOscDipoleData{13}.rotation = -10;%-20;

collOscDipoleData{14}.name = '161201_dipole690';
collOscDipoleData{14}.date = '161201';
collOscDipoleData{14}.magfield = 690;
collOscDipoleData{14}.ODcorr = 1.2;
collOscDipoleData{14}.freqguess = 22;
collOscDipoleData{14}.ampguessy = 3;
collOscDipoleData{14}.ampguessx = 7;
collOscDipoleData{14}.rotation = -10;%-20;

collOscDipoleData{15}.name = '161212_dipole680G';
collOscDipoleData{15}.date = '161212';
collOscDipoleData{15}.magfield = 680;
collOscDipoleData{15}.ODcorr = 1.2;
collOscDipoleData{15}.freqguess = 22;
collOscDipoleData{15}.ampguessy = 3;
collOscDipoleData{15}.ampguessx = 6;
collOscDipoleData{15}.rotation = -10;%-20;

collOscDipoleData{16}.name = '161213_dipole860';
collOscDipoleData{16}.date = '161213';
collOscDipoleData{16}.magfield = 860;
collOscDipoleData{16}.ODcorr = 1.2;
collOscDipoleData{16}.freqguess = 26;
collOscDipoleData{16}.ampguessy = 2.5;
collOscDipoleData{16}.ampguessx = 6;
collOscDipoleData{16}.rotation = -10;%-20;

collOscDipoleData{17}.name = '161214_dipoleOscillation860G';
collOscDipoleData{17}.date = '161214';
collOscDipoleData{17}.magfield = 860;
collOscDipoleData{17}.ODcorr = 1.2;
collOscDipoleData{17}.freqguess = 26;
collOscDipoleData{17}.ampguessy = 3;
collOscDipoleData{17}.ampguessx = 7;
collOscDipoleData{17}.rotation = -10;%-20;

collOscDipoleData{18}.name = '161215_dipoleOscillation832G';
collOscDipoleData{18}.date = '161215';
collOscDipoleData{18}.magfield = 832;
collOscDipoleData{18}.ODcorr = 1.2;
collOscDipoleData{18}.freqguess = 25;
collOscDipoleData{18}.ampguessy = 3.5;
collOscDipoleData{18}.ampguessx = 7;
collOscDipoleData{18}.rotation = -10;%-20;

collOscDipoleData{19}.name = '161216_dipoleOscillation750G';
collOscDipoleData{19}.date = '161216';
collOscDipoleData{19}.magfield = 750;
collOscDipoleData{19}.ODcorr = 1.2;
collOscDipoleData{19}.freqguess = 22;
collOscDipoleData{19}.ampguessy = 3;
collOscDipoleData{19}.ampguessx = 8;
collOscDipoleData{19}.rotation = -10;%-20;

collOscDipoleData{20}.name = '161216_dipoleOscillation860G';
collOscDipoleData{20}.date = '161216';
collOscDipoleData{20}.magfield = 860;
collOscDipoleData{20}.ODcorr = 1.2;
collOscDipoleData{20}.freqguess = 26;
collOscDipoleData{20}.ampguessy = 3;
collOscDipoleData{20}.ampguessx = 8;
collOscDipoleData{20}.rotation = -10;%-20;

collOscDipoleData{21}.name = '161217_dipoleOscillation735G';
collOscDipoleData{21}.date = '161217';
collOscDipoleData{21}.magfield = 735;
collOscDipoleData{21}.ODcorr = 1.2;
collOscDipoleData{21}.freqguess = 24;
collOscDipoleData{21}.ampguessy = 4;
collOscDipoleData{21}.ampguessx = 8;
collOscDipoleData{21}.rotation = -10;%-20;

collOscDipoleData{22}.name = '161219_dipoleOscillation680G';
collOscDipoleData{22}.date = '161219';
collOscDipoleData{22}.magfield = 680;
collOscDipoleData{22}.ODcorr = 1.2;
collOscDipoleData{22}.freqguess = 22;
collOscDipoleData{22}.ampguessy = 3;
collOscDipoleData{22}.ampguessx = 9;
collOscDipoleData{22}.rotation = -10;%-20;

collOscDipoleData{23}.name = '161219_dipoleOscillation690G';
collOscDipoleData{23}.date = '161219';
collOscDipoleData{23}.magfield = 690;
collOscDipoleData{23}.ODcorr = 1.2;
collOscDipoleData{23}.freqguess = 22;
collOscDipoleData{23}.ampguessy = 3;
collOscDipoleData{23}.ampguessx = 10;
collOscDipoleData{23}.rotation = -10;%-20;

collOscDipoleData{24}.name = '161219_dipoleOscillation700G';
collOscDipoleData{24}.date = '161219';
collOscDipoleData{24}.magfield = 700;
collOscDipoleData{24}.ODcorr = 1.2;
collOscDipoleData{24}.freqguess = 22;
collOscDipoleData{24}.ampguessy = 4;
collOscDipoleData{24}.ampguessx = 9;
collOscDipoleData{24}.rotation = -10;%-20;

collOscDipoleData{25}.name = '161222_dipole700G0p4V';
collOscDipoleData{25}.date = '161222';
collOscDipoleData{25}.magfield = 700;
collOscDipoleData{25}.ODcorr = 1.2;
collOscDipoleData{25}.freqguess = 22;
collOscDipoleData{25}.ampguessy = 1.5;
collOscDipoleData{25}.ampguessx = 3;
collOscDipoleData{25}.rotation = -10;%-20;

collOscDipoleData{26}.name = '161222_dipole700G0p8V';
collOscDipoleData{26}.date = '161222';
collOscDipoleData{26}.magfield = 700;
collOscDipoleData{26}.ODcorr = 1.2;
collOscDipoleData{26}.freqguess = 22;
collOscDipoleData{26}.ampguessy = 4;
collOscDipoleData{26}.ampguessx = 11;
collOscDipoleData{26}.rotation = -10;%-20;

collOscDipoleData{27}.name = '161222_dipole700G1p4V';
collOscDipoleData{27}.date = '161222';
collOscDipoleData{27}.magfield = 700;
collOscDipoleData{27}.ODcorr = 1.2;
collOscDipoleData{27}.freqguess = 22;
collOscDipoleData{27}.ampguessy = 6;
collOscDipoleData{27}.ampguessx = 14;
collOscDipoleData{27}.rotation = -10;%-20;

collOscDipoleData{28}.name = '161223_dipole700G0p8V';
collOscDipoleData{28}.date = '161223';
collOscDipoleData{28}.magfield = 700;
collOscDipoleData{28}.ODcorr = 1.2;
collOscDipoleData{28}.freqguess = 22;
collOscDipoleData{28}.ampguessy = 5;
collOscDipoleData{28}.ampguessx = 9;
collOscDipoleData{28}.rotation = -10;%-20;

collOscDipoleData{29}.name = '161223_dipole700G0p8V_2';
collOscDipoleData{29}.date = '161223';
collOscDipoleData{29}.magfield = 700;
collOscDipoleData{29}.ODcorr = 1.2;
collOscDipoleData{29}.freqguess = 22;
collOscDipoleData{29}.ampguessy = 5;
collOscDipoleData{29}.ampguessx = 10;
collOscDipoleData{29}.rotation = -10;%-20;

collOscDipoleData{30}.name = '170111_dipole690G';
collOscDipoleData{30}.date = '170111';
collOscDipoleData{30}.magfield = 690;
collOscDipoleData{30}.ODcorr = 1.2;
collOscDipoleData{30}.freqguess = 22;
collOscDipoleData{30}.ampguessy = 4;
collOscDipoleData{30}.ampguessx = 5;
collOscDipoleData{30}.rotation = -10;%-35;

collOscDipoleData{31}.name = '170111_Dipole690G_2';
collOscDipoleData{31}.date = '170111';
collOscDipoleData{31}.magfield = 690;
collOscDipoleData{31}.ODcorr = 1.2;
collOscDipoleData{31}.freqguess = 22;
collOscDipoleData{31}.ampguessy = 5;
collOscDipoleData{31}.ampguessx = 5;
collOscDipoleData{31}.rotation = -10;%-35;

collOscDipoleData{32}.name = '170111_dipole690G_aftClean';
collOscDipoleData{32}.date = '170111';
collOscDipoleData{32}.magfield = 690;
collOscDipoleData{32}.ODcorr = 1.2;
collOscDipoleData{32}.freqguess = 22;
collOscDipoleData{32}.ampguessy = 4;
collOscDipoleData{32}.ampguessx = 3;
collOscDipoleData{32}.rotation = -10;%-45;

collOscDipoleData{33}.name = '170112_dipole_690G_2';
collOscDipoleData{33}.date = '170112';
collOscDipoleData{33}.magfield = 690;
collOscDipoleData{33}.ODcorr = 1.2;
collOscDipoleData{33}.freqguess = 22;
collOscDipoleData{33}.ampguessy = 5;
collOscDipoleData{33}.ampguessx = 5;
collOscDipoleData{33}.rotation = -10;%-45;

collOscDipoleData{34}.name = '170112_dipole690G_1';
collOscDipoleData{34}.date = '170112';
collOscDipoleData{34}.magfield = 690;
collOscDipoleData{34}.ODcorr = 1.2;
collOscDipoleData{34}.freqguess = 22;
collOscDipoleData{34}.ampguessy = 2.5;
collOscDipoleData{34}.ampguessx = 5;
collOscDipoleData{34}.rotation = -10;%-45;

collOscDipoleData{35}.name = '170112_dipole690G_3';
collOscDipoleData{35}.date = '170112';
collOscDipoleData{35}.magfield = 690;
collOscDipoleData{35}.ODcorr = 1.2;
collOscDipoleData{35}.freqguess = 22;
collOscDipoleData{35}.ampguessy = 5;
collOscDipoleData{35}.ampguessx = 4;
collOscDipoleData{35}.rotation = -10;%-45;

collOscDipoleData{36}.name = '170113_dipole690G';
collOscDipoleData{36}.date = '170113';
collOscDipoleData{36}.magfield = 690;
collOscDipoleData{36}.ODcorr = 1.2;
collOscDipoleData{36}.freqguess = 22;
collOscDipoleData{36}.ampguessy = 4;
collOscDipoleData{36}.ampguessx = 4;
collOscDipoleData{36}.rotation = -10;%-45;

collOscDipoleData{37}.name = '170119_dipole690G';
collOscDipoleData{37}.date = '170119';
collOscDipoleData{37}.magfield = 690;
collOscDipoleData{37}.ODcorr = 1.2;
collOscDipoleData{37}.freqguess = 22;
collOscDipoleData{37}.ampguessy = 3.5;
collOscDipoleData{37}.ampguessx = 8;
collOscDipoleData{37}.rotation = -10;%21;

collOscDipoleData{38}.name = '170119_dipole860G';
collOscDipoleData{38}.date = '170119';
collOscDipoleData{38}.magfield = 860;
collOscDipoleData{38}.ODcorr = 1.2;
collOscDipoleData{38}.freqguess = 25;
collOscDipoleData{38}.ampguessy = 2;
collOscDipoleData{38}.ampguessx = 6;
collOscDipoleData{38}.rotation = -10;%15;

collOscDipoleData{39}.name = '170120_dipole860G';
collOscDipoleData{39}.date = '170120';
collOscDipoleData{39}.magfield = 860;
collOscDipoleData{39}.ODcorr = 1.2;
collOscDipoleData{39}.freqguess = 25;
collOscDipoleData{39}.ampguessy = 2.5;
collOscDipoleData{39}.ampguessx = 6;
collOscDipoleData{39}.rotation = -10;%15;

collOscDipoleData{40}.name = '170123_dipole700G';
collOscDipoleData{40}.date = '170123';
collOscDipoleData{40}.magfield = 700;
collOscDipoleData{40}.ODcorr = 1.2;
collOscDipoleData{40}.freqguess = 22;
collOscDipoleData{40}.ampguessy = 3;
collOscDipoleData{40}.ampguessx = 8;
collOscDipoleData{40}.rotation = -10;%15;

collOscDipoleData{41}.name = '170127_dipole712G';
collOscDipoleData{41}.date = '170127';
collOscDipoleData{41}.magfield = 712;
collOscDipoleData{41}.ODcorr = 1.2;
collOscDipoleData{41}.freqguess = 22;
collOscDipoleData{41}.ampguessy = 8;
collOscDipoleData{41}.ampguessx = 9;
collOscDipoleData{41}.rotation = -10;%-15;

collOscDipoleData{42}.name = '170130_dipole712G';
collOscDipoleData{42}.date = '170130';
collOscDipoleData{42}.magfield = 712;
collOscDipoleData{42}.ODcorr = 1.2;
collOscDipoleData{42}.freqguess = 22;
collOscDipoleData{42}.ampguessy = 4;
collOscDipoleData{42}.ampguessx = 10;
collOscDipoleData{42}.rotation = -10;%-15;

collOscDipoleData{43}.name = '170531_dipole725G';
collOscDipoleData{43}.date = '170531';
collOscDipoleData{43}.magfield = 725;
collOscDipoleData{43}.ODcorr = 1.28;
collOscDipoleData{43}.freqguess = 23;
collOscDipoleData{43}.ampguessy = 6;
collOscDipoleData{43}.ampguessx = 10;
collOscDipoleData{43}.rotation = 30;%15;

collOscDipoleData{44}.name = '170531_dipole860G';
collOscDipoleData{44}.date = '170531';
collOscDipoleData{44}.magfield = 860;
collOscDipoleData{44}.ODcorr = 1.28;
collOscDipoleData{44}.freqguess = 25;
collOscDipoleData{44}.ampguessy = 6;
collOscDipoleData{44}.ampguessx = 10;
collOscDipoleData{44}.rotation = 30;%15;

collOscDipoleData{45}.name = '170531_dipole832G';
collOscDipoleData{45}.date = '170531';
collOscDipoleData{45}.magfield = 832;
collOscDipoleData{45}.ODcorr = 1.28;
collOscDipoleData{45}.freqguess = 24.5;
collOscDipoleData{45}.ampguessy = 6;
collOscDipoleData{45}.ampguessx = 10;
collOscDipoleData{45}.rotation = 30;%15;

collOscDipoleData{46}.name = '170530_dipole700G';
collOscDipoleData{46}.date = '170530';
collOscDipoleData{46}.magfield = 700;
collOscDipoleData{46}.ODcorr = 1.28;
collOscDipoleData{46}.freqguess = 22;
collOscDipoleData{46}.ampguessy = 6;
collOscDipoleData{46}.ampguessx = 10;
collOscDipoleData{46}.rotation = 30; %15;

collOscDipoleData{47}.name = '170602_dipole690G5p62kHz';
collOscDipoleData{47}.date = '170602';
collOscDipoleData{47}.magfield = 690;
collOscDipoleData{47}.ODcorr = 1.28;
collOscDipoleData{47}.freqguess = 22;
collOscDipoleData{47}.ampguessy = 6;
collOscDipoleData{47}.ampguessx = 10;
collOscDipoleData{47}.rotation = 30; %28

collOscDipoleData{48}.name = '170626_dipole690G';
collOscDipoleData{48}.date = '170626';
collOscDipoleData{48}.magfield = 690;
collOscDipoleData{48}.ODcorr = 1.28;
collOscDipoleData{48}.freqguess = 22;
collOscDipoleData{48}.ampguessy = 6;
collOscDipoleData{48}.ampguessx = 10;
collOscDipoleData{48}.rotation = 30;

collOscDipoleData{49}.name = '170626_dipole860G';
collOscDipoleData{49}.date = '170626';
collOscDipoleData{49}.magfield = 860;
collOscDipoleData{49}.ODcorr = 1.28;
collOscDipoleData{49}.freqguess = 25;
collOscDipoleData{49}.ampguessy = 6;
collOscDipoleData{49}.ampguessx = 10;
collOscDipoleData{49}.rotation = 30;

collOscDipoleData{50}.name = '170627_dipole832G';
collOscDipoleData{50}.date = '170627';
collOscDipoleData{50}.magfield = 832;
collOscDipoleData{50}.ODcorr = 1.28;
collOscDipoleData{50}.freqguess = 25;
collOscDipoleData{50}.ampguessy = 6;
collOscDipoleData{50}.ampguessx = 10;
collOscDipoleData{50}.rotation = 30;

collOscDipoleData{51}.name = '170628_dipole690G';
collOscDipoleData{51}.date = '170628';
collOscDipoleData{51}.magfield = 690;
collOscDipoleData{51}.ODcorr = 1.28;
collOscDipoleData{51}.freqguess = 22;
collOscDipoleData{51}.ampguessy = 6;
collOscDipoleData{51}.ampguessx = 10;
collOscDipoleData{51}.rotation = 30;


%------------Function call:
saveparam = 1; % 1 is save on, 0 is save off
numofdatas = length(collOscDipoleData);
datastart = 1; dataend = numofdatas;

frequencyResults = []; frequencyResultsError =[];
for i=datastart:dataend
%for i=43:43
    
    [collOscDipoleData{i}.freqresult, collOscDipoleData{i}.freqresulterror, collOscDipoleData{i}.atomnum, collOscDipoleData{i}.freqx, collOscDipoleData{i}.freqxerror, collOscDipoleData{i}.freqy, collOscDipoleData{i}.freqyerror, collOscDipoleData{i}.geomeanfreq, collOscDipoleData{i}.pcafreq, collOscDipoleData{i}.pcafreqerror, collOscDipoleData{i}.aspectratio, collOscDipoleData{i}.centersx, collOscDipoleData{i}.centersy, collOscDipoleData{i}.centersxs] = master_collOsc_dipole_function(collOscDipoleData{i},saveparam);
    dispmessage = ['Completed dataset number: ' num2str(i) '/' num2str(numofdatas) ' '];
    disp(dispmessage);
    
end

versionnumber = 19;
%v4 is with first iteration of custom dipole, with the exponential set to 0
%v5 included pca mode 1 frequency
%v6,v7 is dummy, to gen pca images
%v8 with first amplitude guesses
%v9 with freq guess from function (inside master dipole func)
%v10 with tightened frequencies
%v11 added rotation amounts
%v12 rotations updated and aspect ratios added
%v14 removed 'ceil' to round centers, added centers output
%v15 added dipole data from week of 30th/5th
%v17 added four more month of june
%v18 rotation changed to 'stripes' angle (30 for new trap angle, -10 for old)
fileNameforcsv = ['C:\Users\tpeppler\Dropbox\PhD\2D_2017\ColOsc Data Review\collOscDipoleDatacellv' num2str(versionnumber) '.csv']; 

names = []; dates = []; magfields = []; ODcorrs = []; freqguesss = []; freqresults = []; freqresultserror = []; atomnums = []; freqxs = []; freqxerrors = [];
freqys = []; freqyerrors = []; geomeanfreqs = []; pcafreqs = []; pcafreqserror = []; aspectratios = [];
for i=datastart:dataend
    names{i} = collOscDipoleData{i}.name; 
    dates{i} = collOscDipoleData{i}.date; 
    magfields(i) = collOscDipoleData{i}.magfield; 
    ODcorrs(i) = collOscDipoleData{i}.ODcorr; 
    freqguesss(i) = collOscDipoleData{i}.freqguess; 
    freqresults(i) = collOscDipoleData{i}.freqresult;
    freqresultserror(i) = collOscDipoleData{i}.freqresulterror;
    atomnums(i) = collOscDipoleData{i}.atomnum;
    freqxs(i) = collOscDipoleData{i}.freqx;
    freqxerrors(i) = collOscDipoleData{i}.freqxerror;
    freqys(i) = collOscDipoleData{i}.freqy;
    freqyerrors(i) = collOscDipoleData{i}.freqyerror;
    geomeanfreqs(i) = collOscDipoleData{i}.geomeanfreq;
    pcafreqs(i) = collOscDipoleData{i}.pcafreq;
    pcafreqserror(i) = collOscDipoleData{i}.pcafreqerror;
    aspectratios(i) = collOscDipoleData{i}.aspectratio;
    %centersx(i,:) = collOscDipoleData{i}.centersx;
    %centersy(i,:) = collOscDipoleData{i}.centersy;
    %centersxs{i} = collOscDipoleData{i}.centersxs;
end


datatable = table(names',dates',magfields',ODcorrs',freqguesss',freqresults',freqresultserror',atomnums',freqxs',freqxerrors',freqys', freqyerrors',geomeanfreqs',pcafreqs',pcafreqserror',aspectratios');

writetable(datatable,fileNameforcsv);












